<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/utils/dom.js | px-mobile.js API API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a data-ice="repoURL" href="git+https://github.com/jonniespratley/px-mobilejs.git">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/base.js~BaseClass.html">BaseClass</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-pxMobile">pxMobile</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/x-module.js~xModule.html">xModule</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">core</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/core.js~Core.html">Core</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/plugins.js~Plugins.html">Plugins</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/pubsub.js~PubSub.html">PubSub</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/router-history.js~RouterHistory.html">RouterHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/router.js~Router.html">Router</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/service-locator.js~ServiceLocator.html">ServiceLocator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/simple-router.js~SimpleRouter.html">SimpleRouter</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">ds</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ds/collection.js~Collection.html">Collection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ds/db.js~DB.html">DB</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ds/http.js~HTTP.html">HTTP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ds/model.js~Model.html">Model</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">elements</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/elements/pm-page.js~pmPage.html">pmPage</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">ui</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/app.js~App.html">App</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/component.js~Component.html">Component</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/element.js~Element.html">Element</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/elements.js~Elements.html">Elements</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/page.js~Page.html">Page</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/pages.js~Pages.html">Pages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/view.js~View.html">View</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ui/views.js~Views.html">Views</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/dom.js~DOM.html">DOM</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/interface.js~Interface.html">Interface</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/log.js~Logger.html">Logger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dom">dom</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addMixin">addMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-debounce">debounce</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-extend">extend</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-extendClass">extendClass</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-extendDeep">extendDeep</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mix">mix</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mixin">mixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-resolveURL">resolveURL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-type">type</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-uuid">uuid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-$">$</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Interfaces">Interfaces</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-aggregation">aggregation</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/utils/dom.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;
/**
 * dom class provides various utility methods on a document element.
 * @example
 * var $ = selector =&gt; new DOM(selector);
 */
export default class DOM {


	constructor(selector, context) {
		console.time(&apos;dom&apos;);
		var matches = {
			&apos;#&apos;: &apos;getElementById&apos;,
			&apos;.&apos;: &apos;getElementsByClassName&apos;,
			&apos;@&apos;: &apos;getElementsByName&apos;,
			&apos;=&apos;: &apos;getElementsByTagName&apos;,
			&apos;*&apos;: &apos;querySelectorAll&apos;
		};
		var match = matches[selector[0]];
		if (!match) {
			match = &apos;querySelectorAll&apos;;
		}
		var out = null,
			el;

		try {
			el = (((context === undefined) ? document : context)[matches](selector.slice(1)));
			out = ((el.length &lt; 2) ? el[0] : el);

		} catch (err) {

		}
		this.length = el.length || 0;
		Object.assign(this, out);
		return this;
	}

	find(selector, context) {

	}



	clone() {

		}
		/**
		 * @param {Function} callback A callback to call on each element
		 */
	each(callback) {
		// convert this to Array to use for...of
		for (let el of Array.from(this)) {
			callback.call(el);
		}
		return this;
	}

	/**
	 * Add a class to selected elements
	 * @param {String} className The class name to add
	 */
	addClass(className) {
		return this.each(function () {
			if (this.classList) {
				this.classList.add(className);
			} else {
				this.className += &apos; &apos; + className;
			}
		});
	}

	/**
	 * Remove a class from selected elements
	 * @param {String} className The class name to remove
	 */
	removeClass(className) {
		return this.each(function () {
			this.classList.remove(className);
		});
	}

	/**
	 * Check to see if the element has a class
	 * (Note: Only checks the first elements if more than one is selected)
	 * @param {String} className The class name to check
	 */
	hasClass(className) {
		if (this.classList) {
			return this.classList.contains(className);
		} else {
			return new RegExp(&apos;(^| )&apos; + className + &apos;( |$)&apos;, &apos;gi&apos;).test(this.className);
		}
	}

	toggleClass(className) {
		var el = this;
		if (el.classList) {
			el.classList.toggle(className);
		} else {
			var classes = el.className.split(&apos; &apos;);
			var existingIndex = classes.indexOf(className);

			if (existingIndex &gt;= 0) {
				classes.splice(existingIndex, 1);
			} else {
				classes.push(className);
			}
			el.className = classes.join(&apos; &apos;);
		}
	}

	css(prop, value) {
		if (value) {
			this.style[prop] = value;
			return this;
		} else if (prop) {
			return this.style[prop];
		} else {
			return this.style;
		}
	}

	attr(name, value) {
		name = name.toLowerCase();

		if (value) {
			this.setAttribute(name, value);
			return this;
		} else {
			return this.getAttribute(name);
		}
	}

	data(name, value) {
		if (value) {
			this.setAttribute(&apos;data-&apos; + name, value);
			return this;
		} else {
			return this.getAttribute(&apos;data-&apos; + name);
		}
	}

	on(event, callback) {
		return this.each(function () {
			this.addEventListener(event, callback, false);
		});
	}

	_on(eventName, eventHandler) {
		eventType = eventType.split(&apos; &apos;);
		for (var i = 0; i &lt; eventType.length; i++) {
			this.addEventListener(eventType[i], callback);
		}
		return this;
	}

	off(eventName, eventHandler) {
		this.removeEventListener(eventName, eventHandler);
	}

	trigger(eventName, eventData) {
		var event;
		if (window.CustomEvent) {
			event = new CustomEvent(eventName, {
				detail: eventData
			});
		} else {
			event = document.createEvent(&apos;CustomEvent&apos;);
			event.initCustomEvent(eventName, true, true, eventData);
		}
		return this.dispatchEvent(event);
	}

	empty() {
		this.innerHTML = &apos;&apos;;
		return this;
	}

	html(html) {
		if (html) {
			this.innerHTML = html;
			return this;
		} else {
			return this.innerHTML;
		}
	}

	text(text) {
		if (text) {
			this.textContent = text;
			return this;
		} else {
			return this.textContent;
		}
	}
	next() {
		return this.nextElementSibling;
	}
	prev() {

	}
	parent() {
		return this.parentNode;
	}
	child() {

	}
	position() {

	}
}



var dom = function (selector, context, undefined) {


	var matches = {
		&apos;#&apos;: &apos;getElementById&apos;,
		&apos;.&apos;: &apos;getElementsByClassName&apos;,
		&apos;@&apos;: &apos;getElementsByName&apos;,
		&apos;=&apos;: &apos;getElementsByTagName&apos;,
		&apos;*&apos;: &apos;querySelectorAll&apos;
	}[selector[0]];

	//console.warn(&apos;dom()&apos;, matches, selector);
	var out = null,
		el;
	try {
		el = (((context === undefined) ? document : context)[matches](selector.slice(1)));
		out = ((el.length &lt; 2) ? el[0] : el);
		//console.warn(&apos;found&apos;, el);
	} catch (err) {
		//console.error(&apos;error&apos;, selector, &apos;not found&apos;);
	}

	return out;
};

//dom.extend({}, objA, objB);
dom.extend = function (out) {
	out = out || {};
	for (var i = 1; i &lt; arguments.length; i++) {
		if (!arguments[i]) {
			continue;
		}
		for (var key in arguments[i]) {
			if (arguments[i].hasOwnProperty(key)) {
				out[key] = arguments[i][key];
			}
		}
	}
	return out;
};



// TODO: Extend Element on Window.
(function (win) {

	/* Keep source code the same */
	if (!win || !win.Element) {
		return;
	}

	//dom(&apos;#iddiv&apos;).find(&apos;.inside&apos;)
	win.Element.prototype.find = function (selector) {
		return dom(selector, this);
	};

	win.Element.prototype.append = function (el) {
		return this.appendChild(el);
	};

	//dom(el).clone()
	win.Element.prototype.clone = function () {
		return this.cloneNode(true);
	};

	//dom(el).hasClass(name)
	window.Element.prototype.hasClass = function (className) {
		if (this.classList) {
			return this.classList.contains(className);
		} else {
			return new RegExp(&apos;(^| )&apos; + className + &apos;( |$)&apos;, &apos;gi&apos;).test(this.className);
		}
	};

	//dom(el).addClass(name)
	win.Element.prototype.addClass = function (className) {
		var classes = className.split(&apos; &apos;);
		for (var i = 0; i &lt; classes.length; i++) {
			if (this.classList) {
				this.classList.add(classes[i]);
			} else {
				this.className += &apos; &apos; + classes[i];
			}
		}
		return this;
	};

	//dom(el).removeClass(name)
	win.Element.prototype.removeClass = function (className) {
		var el = this;
		if (el.classList &amp;&amp; className) {
			el.classList.remove(className);
		} else if(el.classList &amp;&amp; !className){
			el.classList.forEach(function(cla){
				el.removeClass(cla);
			});
		}
		else {
			el.className = el.className.replace(new RegExp(&apos;(^|\\b)&apos; + className.split(&apos; &apos;).join(&apos;|&apos;) + &apos;(\\b|$)&apos;, &apos;gi&apos;), &apos; &apos;);
		}
		return this;
	};

	//dom(el).toggleClass(name)
	win.Element.prototype.toggleClass = function (className) {
		var el = this;
		if (el.classList) {
			el.classList.toggle(className);
		} else {
			var classes = el.className.split(&apos; &apos;);
			var existingIndex = classes.indexOf(className);

			if (existingIndex &gt;= 0) {
				classes.splice(existingIndex, 1);
			} else {
				classes.push(className);
			}
			el.className = classes.join(&apos; &apos;);
		}
	};

	//dom().css(&apos;prop&apos;, &apos;value&apos;) support
	win.Element.prototype.css = function (prop, value) {
		if (value) {
			this.style[prop] = value;
			return this;
		} else if (prop) {
			return this.style[prop];
		} else {
			return this.style;
		}
	};

	//dom(selector).attr(&apos;prop&apos;, &apos;value&apos;)
	win.Element.prototype.attr = function (name, value) {
		name = name.toLowerCase();

		if (value) {
			this.setAttribute(name, value);
			return this;
		} else {
			return this.getAttribute(name);
		}
	};

	win.Element.prototype.data = function (name, value) {
		if (value) {
			this.setAttribute(&apos;data-&apos; + name, value);
			return this;
		} else {
			return this.getAttribute(&apos;data-&apos; + name);
		}
	};



	win.Element.prototype.on = function (eventType, callback) {
		eventType = eventType.split(&apos; &apos;);
		for (var i = 0; i &lt; eventType.length; i++) {
			this.addEventListener(eventType[i], callback);
		}
		return this;
	};

	//px.mobile.dom(&apos;#sandbox&apos;).off(&apos;click&apos;, handler);
	win.Element.prototype.off = function (eventName, eventHandler) {
		this.removeEventListener(eventName, eventHandler);
	};


	//px.mobile.dom(&apos;#sandbox&apos;).trigger(&apos;custom-event&apos;, {name: &apos;value&apos;});
	win.Element.prototype.trigger = function (eventName, eventData) {
		var event;
		if (
			win.CustomEvent) {
			event = new CustomEvent(eventName, {
				detail: eventData
			});
		} else {
			event = document.createEvent(&apos;CustomEvent&apos;);
			event.initCustomEvent(eventName, true, true, eventData);
		}
		return this.dispatchEvent(event);
	};


	//dom(el).empty();
	win.Element.prototype.empty = function () {
		this.innerHTML = &apos;&apos;;
		return this;
	};

	//dom(el).html();
	win.Element.prototype.html = function (html) {
		if (html) {
			this.innerHTML = html;
			return this;
		} else {
			return this.innerHTML;
		}
	};

	//dom(el).text();
	win.Element.prototype.text = function (text) {
		if (text) {
			this.textContent = text;
			return this;
		} else {
			return this.textContent;
		}
	};

	//dom(el).next();
	win.Element.prototype.next = function () {
		return this.nextElementSibling;
	};

	//dom(el).parent();
	win.Element.prototype.parent = function () {
		return this.parentNode;
	};

	//dom(el).remove();
	win.Element.prototype.remove = function () {
		return this.parentNode.removeChild(this);
	};

	win.Element.prototype.child = function (el) {
		if(el){
			return this.querySelectorAll(el);
		} else {
			return this.children;
		}
	};

	//dom(el).position();
	win.Element.prototype.position = function () {
		var pos = {
			left: this.offsetLeft,
			top: this.offsetTop
		};
		return pos;
	};

	// TODO: Extend nodelist

	//dom().addClass(&apos;name&apos;);
	win.NodeList.prototype.addClass = function (name) {
		this.each(function (el) {
			el.classList.add(name);
		});
		return this;
	};

	// $().removeClass(&apos;name&apos;);
	win.NodeList.prototype.removeClass = function (name) {
		this.each(function (el) {
			el.classList.remove(name);
		});
		return this;
	};



	// doing a find in a NodeList doesnt really work. I had a function that
	// would look inside and get the element but it was pretty big and
	// required recusive searching inside NodeLists. So I would suggest just
	// using a &apos;*&apos; selection method
	win.NodeList.prototype.find = function find(elem) {
		console.error(&apos;You cannot find in a NodeList. Just use $(*selector %s)&apos;, elem);
		return this;
	};

	// another useful one for doing $(&apos;.inside&apos;).each()
	win.NodeList.prototype.each = Array.prototype.forEach;


	win.NodeList.prototype.attr = function (name, value) {
		this.each(function (el) {
			if (value) {
				el.setAttribute(name, value);
			} else {
				return el.getAttribute(name);
			}
		});
		return this;
	};

	win.NodeList.prototype.toggleClass = function (className) {
		this.each(function (el) {
			el.toggleClass(className);
		});
		return this;
	};


	win.NodeList.prototype.css = function (prop, value) {
		this.each(function (el) {
			el.css(prop, value);
		});
		return this;
	};



	win.NodeList.prototype.on = function (eventType, callback) {
		this.each(function (el) {
			el.on(eventType, callback);
		});
		return this;
	};



	win.NodeList.prototype.first = function () {
		return (this.length &lt; 2) ? this : this[0];
	};

	win.NodeList.prototype.last = function () {
		// if there are many items, return the last
		return (this.length &gt; 1) ? this[this.length - 1] : this;
	};


})(typeof window == &quot;undefined&quot; ? global : window);


export var $ = selector =&gt; dom(selector);
export default dom;
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.3)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
